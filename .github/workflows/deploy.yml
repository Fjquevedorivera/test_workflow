name: GitHub Actions Demoo
run-name: ${{ github.actor }} is testing out GitHub Actions üöÄ
on: 
  push:
    branches: 
      - 'main' 
  workflow_dispatch:
    branches: 
      - 'develop' 
    inputs:
      region:
        description: 'Google Cloud Region'
        required: true
        default: 'us-central1'

jobs:
  # Este es el nombre del trabajo espec√≠fico dentro del flujo de trabajo.
  # El trabajo contiene una serie de pasos que se ejecutan secuencialmente.
  Explore-GitHub-Actions:
    # El trabajo se ejecutar√° en una m√°quina virtual Ubuntu con la versi√≥n m√°s reciente. 
    runs-on: ubuntu-latest
    steps:
      # {{ github.event_name }} se reemplaza con el nombre del evento que activ√≥ el flujo de trabajo (en este caso, push).
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      # Se imprime otro mensaje indicando que el trabajo se est√° ejecutando en un servidor con el sistema operativo {{ runner.os }} (en este caso, Ubuntu).
      - run: echo "üêß This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      # {{ github.ref }} se reemplaza con el nombre de la rama actual.
      # {{ github.repository }} se reemplaza con el nombre completo del repositorio (nombre de usuario/repositorio).
      - run: echo "üîé The name of your branch is ${{ github.ref }} and your repository is ${{ github.repository }}."
      # Este paso tiene un nombre personalizado para mejorar la legibilidad.
      # Esta acci√≥n descarga el c√≥digo del repositorio al servidor donde se ejecuta el trabajo.
      - name: Check out repository code
      # En este paso se utiliza una acci√≥n predefinida llamada actions/checkout@v4.
      # Toma todo el c√≥digo de tu proyecto que est√° en GitHub (el c√≥digo fuente, im√°genes, etc.) y lo copia.
      # "al servidor donde se ejecuta el trabajo"
        uses: actions/checkout@v4
      # Se imprime un mensaje confirmando que el repositorio {{ github.repository }} se ha clonado en el servidor.
      - run: echo "üí° The ${{ github.repository }} repository has been cloned to the runner."
      # Se imprime un mensaje indicando que el flujo de trabajo est√° listo para probar el c√≥digo en el servidor.
      - run: echo "üñ•Ô∏è The workflow is now ready to test your code on the runner."
      # Este paso tambi√©n tiene un nombre personalizado para mejorar la legibilidad.
      - name: List files in the repository
      # Se utiliza el comando ls para listar los archivos en el directorio de trabajo ({{ github.workspace }}) del runner.
        run: |
          ls ${{ github.workspace }}
      # ---------------------------------------------------------------------------------
      - name: Set up Terraform
        uses: hashicorp/setup-terraform@v1
      # -----------------------------------------------------------------------------------
      - name: Verify Terraform version
        run: terraform --version
      # -----------------------------------------------------------------------------------
      - name: Authenticate to Google Cloud
        run: |
          echo "$GOOGLE_CREDENTIALS" > credentials.json
          ls ${{ github.workspace }}
        env:
          GOOGLE_CREDENTIALS: ${{ secrets.GOOGLE_CREDENTIALS }}
      # --test---------------------------------------------------------------------------------
      - name: Test Environment Variables
        run: echo "project id ${PROJECT_ID}"


      # # -----------------------------------------------------------------------------------
      # - name: Extract Cloud Function name from variables.tf
      #   id: extract_name
      #   run: |
      #     FUNCTION_NAME=$(grep 'variable "function_name"' -A 1 ./infrastructure/variables.tf | grep 'default' | cut -d '"' -f 2)
      #     echo "::set-output name=function_name::$FUNCTION_NAME"
      # # -----------------------------------------------------------------------------------
      # - name: Initialize and plan Terraform
      #   id: init_plan
      #   run: |
      #     terraform -chdir="./infrastructure" init
      #     terraform -chdir="./infrastructure" plan -out=tfplan
      # # -----------------------------------------------------------------------------------
      # - name: Apply Terraform for the selected environment
      #   run: terraform -chdir="./infrastructure" apply -auto-approve tfplan

      # # Se imprime un mensaje que indica el estado actual del trabajo ({{ job.status }}).
      # - run: echo "üçè This job's status is ${{ job.status }}."
